<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WebView Bridge Test</title>

  <script type="text/javascript">
    function dismiss() {
      // iOS WKWebView
      if (window.webkit?.messageHandlers?.AppBridge) {
        window.webkit.messageHandlers.AppBridge.postMessage({
          action: "dismiss"
        });
        return;
      }

      // Android WebView
      if (window.AppBridge?.dismiss) {
        window.AppBridge.dismiss();
        return;
      }

      // Web fallback
      console.log("dismiss(): no native bridge available");
    }

    function openExternal(link) {
      const uri = String(link);

      // iOS WKWebView
      if (window.webkit?.messageHandlers?.AppBridge) {
        window.webkit.messageHandlers.AppBridge.postMessage({
          action: "openExternal",
          uri: uri
        });
        return;
      }

      // Android WebView
      if (window.AppBridge?.openExternal) {
        window.AppBridge.openExternal(uri);
        return;
      }

      // Web fallback
      console.log("openExternal(): no native bridge available", uri);
      window.open(uri, "_blank", "noopener,noreferrer");
    }

    document.addEventListener("DOMContentLoaded", function () {
      document.getElementById("back")
        .addEventListener("click", dismiss);

      document.getElementById("link")
        .addEventListener("click", function () {
          openExternal("https://www.wikipedia.org");
        });

      document.getElementById("phone")
        .addEventListener("click", function () {
          openExternal("tel:+34123456789");
        });
    });
  </script>
</head>

<body>
  <h1>WebView bridge test</h1>
  <p>Implement <code>AppBridge.dismiss()</code> and <code>AppBridge.openExternal(url)</code> on your app</p>

  <button id="back">Go back</button>
  <button id="link">Open link</button>
  <button id="phone">Call phone</button>
</body>
</html>
